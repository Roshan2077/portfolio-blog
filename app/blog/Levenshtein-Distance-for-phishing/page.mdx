export const metadata = {
  title: 'Levenshtein Distance: How Attackers Use Simple Math to Fool Your Eyes',
  description:
    'Learn how the Levenshtein distance algorithm is used in phishing attacks and typosquatting, and discover simple defensive measures like choosing the right font.',
  alternates: {
    canonical: '/blog/Levenshtein-Distance-for-phishing',
  },
};

# Levenshtein Distance: How attackers can use simple math to fool your eyes.

The recent npm supply chain attack was a multi-layered beast, and while the initial phishing email was classic social engineering, the real genius was in the payload. The malware didn’t just steal; it deceived [1]. It used a clever technique to swap cryptocurrency wallet addresses on the fly, ensuring that even a careful user might not notice the change until it was too late. The secret ingredient? **The Levenshtein distance**.

---

## The Art of the Swap: Levenshtein in Action

The **Levenshtein distance** measures the "edit distance" between two strings—the number of single-character insertions, deletions, or substitutions needed to change one into the other. The malware in the npm attack used this to make its address swapping incredibly subtle.

Imagine you're about to send crypto to this legitimate address: `1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa`

Your eyes glaze over. It's just a random string of characters. Now, the malware intercepts this. Instead of replacing it with its own, completely different address, it does something smarter. It searches through its own list of wallet addresses and uses the Levenshtein algorithm to find the one that is _most visually similar_ to your intended destination [6].

It might replace your address with this one: `1A1zP1eP5QGefi2DMPTfTL5SLmv7D1vfNa`

Did you spot the difference? The 'i' was swapped for a '1'.

This is "**address poisoning**," an attack that exploits our inability to eyeball long, complex strings of characters [7]. The malware contained a hash table of attacker-controlled wallets. When it intercepted a transaction, it would find the attacker's address with the smallest Levenshtein distance to the original, making the switch nearly impossible to detect with a casual glance [17, attached_file:1].

---

## Weaponizing Levenshtein for Typosquatting

This same principle is the engine behind modern **typosquatting**. An attacker can start with a list of popular domains and use a script to generate thousands of variations with a Levenshtein distance of just 1 or 2 [1]. These are the most common types of typos, making them prime targets [8].

Let's take `twitter.com` as an example. A script can rapidly generate a list of potential phishing domains:

- **Substitutions:** `twiter.com`, `twittter.com`, `twittre.com`
    
- **Insertions:** `twittier.com`, `twitters.com`
    
- **Deletions:** `twtter.com`, `witter.com`
    
- **Transpositions** (using the related Damerau-Levenshtein distance): `tiwtter.com` [8]
    

The attacker then registers any of these that are available and has a fleet of visually deceptive domains ready to deploy. This technique is incredibly effective because it plays on our cognitive biases. We don't read every letter; our brain takes shortcuts.

---

## A Font-Based Defense

So, how do you defend against an attack that targets the way your brain processes visual information? You can fight fire with fire by changing the information itself. The characters 'I', 'l', and '1' might look similar in Arial, but they don't have to.

Enter fonts designed for clarity. Monospaced fonts built for programming are ideal because they are designed to eliminate visual ambiguity. A great choice is **IBM Plex Mono** .

This font was engineered to make characters distinct:

- The zero (`0`) has a dot to distinguish it from 'O'.
    
- The lowercase 'L' (`l`) has a tail to separate it from '1' and 'I'.
    
- The 'r' and 'n' are clearly defined, so they don't blur into an 'm'.
    

By setting a font like IBM Plex Mono as the default in your browser and email client, you are essentially providing your own "visual patch" against this type of deception. It’s a simple, elegant countermeasure to a simple, elegant attack. It forces you to see what’s actually there, not just what you expect to see.



### Further Reading

- [Understanding Levenshtein Distance](https://example.com/levenshtein-distance)
- [Typosquatting: The Invisible Threat](https://example.com/typosquatting)
- [Defensive Design for Security](https://example.com/defensive-design)